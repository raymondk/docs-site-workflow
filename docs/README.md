# ICP CLI Documentation

This directory contains the source documentation for ICP CLI, written in Markdown.

## Structure

```
docs/
├── index.md              # Homepage
├── tutorial.md           # Getting started tutorial
├── guides/               # How-to guides
├── concepts/             # Conceptual explanations
├── reference/            # Technical reference
├── migration/            # Migration guides
└── schemas/              # JSON schemas (not rendered)
```

## Writing Documentation

Write plain Markdown without frontmatter:

```markdown
# Your Page Title

Content here...
```

The build process automatically extracts the title from the first `# Heading` and adds frontmatter to a temporary copy.

### Best Practices

- Use standard Markdown - keep it simple and GitHub-friendly
- Start with H1 heading: `# Title`
- Use relative links: `[text](./other-doc.md)`
- Use `.md` files (not `.mdx`) for better GitHub rendering
- Code blocks with language: ` ```bash `

## Generated Documentation

Some docs are auto-generated from code:

- **`reference/cli.md`** - Generated by `scripts/generate-cli-docs.sh` from CLI command definitions
- **`schemas/*.json`** - Generated by `scripts/generate-config-schemas.sh` from Rust types

Run these scripts when command-line options or config types change.

## Build Process

The documentation website is built using [Astro](https://astro.build/) + [Starlight](https://starlight.astro.build/). The build process is handled by `scripts/prepare-docs.sh`, which:

1. Copies markdown files from `docs/` to `docs-site/.docs-temp/` (excluding schemas and READMEs)
2. Adjusts relative paths and strips `.md` extensions for Starlight's clean URLs
3. Adds frontmatter (extracts title from H1 heading)

This keeps source docs clean and framework-agnostic while enabling a polished documentation site. The script runs automatically during the build process (`npm run build` in `docs-site/`), but you can also run it manually:

```bash
./scripts/prepare-docs.sh
```

## Preview

### On GitHub

Docs are rendered automatically when browsing on GitHub. The directory structure provides natural navigation.

### Local Preview

See the documentation website locally:

```bash
cd ../docs-site
npm run dev
```

This starts a Starlight site at `http://localhost:4321` that reads from this `docs/` directory.

## Deployment

The documentation website is automatically built and deployed to GitHub Pages:
- **URL**: https://dfinity.github.io/icp-cli/
- **Workflow**: `.github/workflows/docs.yml`
- **Triggers**: Push to main, PRs, manual dispatch

## Adding New Documentation

1. Create a `.md` file in the appropriate directory
2. Start with a `# Heading` (used as page title)
3. Write standard Markdown content
4. Add the page to the sidebar in `../docs-site/astro.config.mjs` under the appropriate section:
   ```js
   {
     label: 'Guides',
     items: [
       { label: 'Your New Guide', slug: 'guides/your-new-guide' },
       // ...
     ],
   }
   ```

## Directory Guidelines

- **`guides/`** - Task-oriented, step-by-step instructions
- **`concepts/`** - Understanding-oriented explanations
- **`reference/`** - Information-oriented specifications
- **`migration/`** - Version or tool migration guides

This follows the [Diátaxis](https://diataxis.fr/) documentation framework.
